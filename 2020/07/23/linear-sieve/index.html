<!DOCTYPE html>
<html class="has-navbar-fixed-top">
<head>
    <meta charset="utf-8">
<title>线性筛与积性函数 - Colin&#39;s Space</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css">








    <meta name="description" content="线性筛是一种数论筛法，可以筛出一定范围内的质数或任意积性函数的值。 其中”线性“的含义为 每个数字只被其最小的质因数筛出 ，并非时间复杂度。 假设求积性函数 $f(x)$ 的质数幂 $f(p^k)$ 复杂度为 $t$，则最终复杂度为 $ \mathcal O(n+\frac{n}{\ln n}\times  t)$ 。">
<meta property="og:type" content="article">
<meta property="og:title" content="线性筛与积性函数">
<meta property="og:url" content="http://blog.gyx.me/2020/07/23/linear-sieve/index.html">
<meta property="og:site_name" content="Colin&#39;s Space">
<meta property="og:description" content="线性筛是一种数论筛法，可以筛出一定范围内的质数或任意积性函数的值。 其中”线性“的含义为 每个数字只被其最小的质因数筛出 ，并非时间复杂度。 假设求积性函数 $f(x)$ 的质数幂 $f(p^k)$ 复杂度为 $t$，则最终复杂度为 $ \mathcal O(n+\frac{n}{\ln n}\times  t)$ 。">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-07-23T08:24:49.000Z">
<meta property="article:modified_time" content="2021-07-29T09:40:58.974Z">
<meta property="article:author" content="Colin">
<meta property="article:tag" content="线性筛">
<meta name="twitter:card" content="summary">





<link rel="icon" href="/favicon.png">


<link rel="stylesheet" href="//fonts.loli.net/css?family=Ovo|Source+Code+Pro">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/css/justifiedGallery.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css">


<link rel="stylesheet" href="/css/style.css">


<script defer src="//use.fontawesome.com/releases/v5.0.8/js/all.js"></script>


    
    
    
    
    
    
    
    
    
    

    


<meta name="generator" content="Hexo 5.2.0"></head>
<body>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="/">
                
                    
                    「 Colin&#39;s Space 」
                    
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item "
               href="/archives">Archives</a>
            
            <a class="navbar-item "
               href="/about">About</a>
            
            <a class="navbar-item "
               href="/training">Training</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            <a class="navbar-item search" title="Search" href="javascript:;">
                <i class="fas fa-search"></i>
            </a>
            
            
            <div class="navbar-item is-hoverable has-dropdown is-hidden-mobile is-hidden-tablet-only toc">
                <a class="navbar-item" title="Table of Contents">
                    <i class="fa fa-list"></i>
                </a>
                <div class="navbar-dropdown is-right">
                    
                    
                    
                    
                    <a class="navbar-item" href="#数论函数">1&nbsp;&nbsp;<b>数论函数</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#积性函数">1.1&nbsp;&nbsp;积性函数</a>
                    
                    
                    
                    <a class="navbar-item" href="#完全积性函数">1.2&nbsp;&nbsp;完全积性函数</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#线性筛">2&nbsp;&nbsp;<b>线性筛</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#应用">3&nbsp;&nbsp;<b>应用</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#线性筛质数">3.1&nbsp;&nbsp;线性筛质数</a>
                    
                    
                    
                    <a class="navbar-item" href="#线性筛-mu">3.2&nbsp;&nbsp;线性筛 $\mu$</a>
                    
                    
                    
                    <a class="navbar-item" href="#线性筛-varphi">3.3&nbsp;&nbsp;线性筛 $\varphi$</a>
                    
                    
                    
                    <a class="navbar-item" href="#关于-sigma-k">3.4&nbsp;&nbsp;关于 $\sigma_k$</a>
                    
                    
                    
                    <a class="navbar-item" href="#线性筛-tau">3.5&nbsp;&nbsp;线性筛 $\tau$</a>
                    
                    
                    
                    <a class="navbar-item" href="#线性筛-sigma">3.6&nbsp;&nbsp;线性筛 $\sigma$</a>
                    
                    
                    
                    <a class="navbar-item" href="#线性筛-sigma-k">3.7&nbsp;&nbsp;线性筛 $\sigma_k$</a>
                    
                    
                    
                    <a class="navbar-item" href="#优化">3.8&nbsp;&nbsp;优化</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#例题">4&nbsp;&nbsp;<b>例题</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#2018-南京网络预赛-Sum">4.1&nbsp;&nbsp;[2018 南京网络预赛] Sum</a>
                    
                </div>
            </div>
            
            
            <a class="navbar-item" title="About" href="/comments">
                
                <i class="fa fa-edit"></i>
                
            </a>
               
            
        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            线性筛与积性函数
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            
                <span>Jul 23 2020</span>
                <span class="second-date-block"> (<time datetime="2020-07-23T08:24:49.000Z" itemprop="datePublished">Jul 23 2020</time>)</span>
            
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/categories/Algorithm/">Algorithm</a>
        </span>
        
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <html><head></head><body><p>线性筛是一种数论筛法，可以筛出一定范围内的质数或<strong>任意积性函数</strong>的值。</p>
<p>其中”线性“的含义为 <strong>每个数字只被其最小的质因数筛出</strong> ，并非时间复杂度。</p>
<p>假设求积性函数 $f(x)$ 的质数幂 $f(p^k)$ 复杂度为 $t$，则最终复杂度为 $ \mathcal O(n+\frac{n}{\ln n}\times  t)$ 。</p>
<a id="more"></a>

<h2 id="数论函数"><a href="#数论函数" class="headerlink" title="数论函数"></a>数论函数</h2><p>定义域为正整数集 $\mathbb N^+$，陪域为复数集 $\mathbb C$ 的函数。</p>
<p>常见的数论函数可视为，定义域为正整数，值域为整数的函数。</p>
<h3 id="积性函数"><a href="#积性函数" class="headerlink" title="积性函数"></a>积性函数</h3><p>对于一个数论函数 $f$ ， $\forall\ a\ \bot\ b,\ f(ab) = f(a)\times f(b)$，则称 $f$ 为<strong>积性函数</strong>。</p>
<p>若 $n$ 的标准分解为 $n = p_1^{k_1}\times p_2^{k_2}\times …\times p_m^{k_m}\ (p_1&lt;p_2&lt;…&lt;p_m)$ ，则<br>$$<br>f(n)=\prod_{i=1}^m f(p_i^{k_i})<br>$$<br>这也是线性筛的基础，即积性函数的基本性质之一就是可被线性筛。</p>
<h3 id="完全积性函数"><a href="#完全积性函数" class="headerlink" title="完全积性函数"></a>完全积性函数</h3><p>对于一个数论函数 $f$ ， $\forall\ a,b\in \mathbb N^+ ,\ f(ab) = f(a)\times f(b)$，则称 $f$ 为<strong>完全积性函数</strong>。</p>
<hr>
<h2 id="线性筛"><a href="#线性筛" class="headerlink" title="线性筛"></a>线性筛</h2><p>求 $f(n)$ 的值时，考虑其标准分解 </p>
<p>$$<br>n = p_1^{k_1}\times p_2^{k_2}\times …\times p_m^{k_m}\ (p_1&lt;p_2&lt;…&lt;p_m)<br>$$</p>
<p>对标准分解的最小质因数的指数 $k_1$ 的情况讨论。</p>
<ul>
<li><p>$n$ 是素数 $p_1$，即 $k_1=m=1$</p>
</li>
<li><p>$n=p_1\times i$，其中 $i$ 是任意正整数，且 $k_1=1$，即 $p_1\nmid i$ </p>
</li>
<li><p>$n=p_1\times i$，其中 $i$ 是任意正整数，且 $k_1&gt;1$，即 $p_1\mid i$ </p>
</li>
</ul>
<p>下面对三类情况分别进行处理：</p>
<ul>
<li><p>$n$ 是素数 $p_1$，即 $k_1=m=1$</p>
<p>往往可以利用数论函数的定义快速求出。</p>
</li>
<li><p>$n=p_1\times i$，其中 $i$ 是任意正整数，且 $k_1=1$，即 $p_1\nmid i$ </p>
<p>利用积性函数的定义，由于 $p_1\bot i$，有 $f(n) = f(p_1) \times f(i)$</p>
<p>由于 $p_1&lt;n,\ i&lt;n$，$f(p_1)$ 和 $f(i)$ 在此前都已求出。</p>
</li>
<li><p>$n=p_1\times i$，其中 $i$ 是任意正整数，且 $k_1&gt;1$，即 $p_1\mid i$ </p>
<p>将 $n$ 重新表示为 $n=p_1^{k_1}\times j$ 的形式，此时 $p_1^{k_1}\bot j$，有$f(n)=f(p_1^{k_1})\times f(j)$</p>
<p>由于 $p_1^{k_1}&lt;n, j&lt;n$，$f(p_1^{k_1})$ 和 $f(j)$ 在此前都已求出。</p>
</li>
</ul>
<p>现在只需要解决如何快速求出 $n$ 对应的 $p_1^{k_1}$ 和 $k_1$ 的值。</p>
<p>不妨设 $g(n)=p_1^{k_1},\ k(n)=k_1$，这两个函数虽然不是积性的，但依然可以按照上述思路讨论。</p>
<table>
<thead>
<tr>
<th align="center">$n$ 与 $p_1$ 关系</th>
<th align="center">$g(n)$</th>
<th align="center">$k(n)$</th>
</tr>
</thead>
<tbody><tr>
<td align="center">$n$ 是素数 $p_1$</td>
<td align="center">$p_1$</td>
<td align="center">$1$</td>
</tr>
<tr>
<td align="center">$n=p_1\times i$，且 $p_1\nmid i$</td>
<td align="center">$p$</td>
<td align="center">$1$</td>
</tr>
<tr>
<td align="center">$n=p_1\times i$，且 $p_1\mid i$</td>
<td align="center">$g(i)\times p_1$</td>
<td align="center">$k(i)+1$</td>
</tr>
</tbody></table>
<p>因此我们可以在线性筛的同时求出 $g(n)$ 和 $k(n)$，复杂度不变。</p>
<hr>
<h2 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h2><p>下面展示一些积性函数的线性筛法。</p>
<p>对应函数的积性证明参考 <a href="">这里</a> ，本篇不再证明。</p>
<p>下面提到的 $n,m,i,j,p,k$ 的定义与上述内容相同。</p>
<h3 id="线性筛质数"><a href="#线性筛质数" class="headerlink" title="线性筛质数"></a>线性筛质数</h3><p>本质上是筛 <strong>最小质因数</strong> $d_{min}(n)=p_1$，若 $d_{min}(n)=n$ 则这个数为质数。</p>
<p>这个函数也不是积性函数，但是对于由当前质数 $p_i$ 筛掉的任意合数 $n$，都有 $d_{min}(n)=p_i$</p>
<div><div class="fold_hider"><div class="close hider_title">Sample-Code</div></div><div class="fold">
<figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; ++i) {</span><br><span class="line">    <span class="hljs-keyword">if</span> (!mindiv[i]) prime[++tot] = mindiv[i] = i;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= tot; ++j) {</span><br><span class="line">        <span class="hljs-keyword">if</span> (prime[j] &gt; mindiv[i] || prime[j] * i &gt; n) <span class="hljs-keyword">break</span>;</span><br><span class="line">    	mindiv[prime[j] * i] = prime[j];</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

</div></div>

<h3 id="线性筛-mu"><a href="#线性筛-mu" class="headerlink" title="线性筛 $\mu$"></a>线性筛 $\mu$</h3><p>莫比乌斯函数 $\mu$ 是积性函数，定义为<br>$$<br>\mu(n)= \begin{cases} 1 \qquad &amp; n=1 \ (-1)^k \qquad &amp; n=\Pi_{i=1}^{k} p_i \ 0 \qquad &amp; \text{otherwise} \end{cases}<br>$$<br>易得 $\mu(p_i^k)=0(k&gt;1)$，直接按条件分讨就可以。</p>
<table>
<thead>
<tr>
<th align="center">$n$ 与 $p_1$ 关系</th>
<th align="center">$\mu(n)$</th>
</tr>
</thead>
<tbody><tr>
<td align="center">$n$ 是素数 $p_1$</td>
<td align="center">$-1$</td>
</tr>
<tr>
<td align="center">$n=p_1\times i$，且 $p_1\nmid i$</td>
<td align="center">$\mu(p_1)\times \mu(i)=-\mu(i)$</td>
</tr>
<tr>
<td align="center">$n=p_1\times i$，且 $p_1\mid i$</td>
<td align="center">$\mu(p_1^{k_1})\times\mu(j)=0$</td>
</tr>
</tbody></table>
<div><div class="fold_hider"><div class="close hider_title">Sample-Code</div></div><div class="fold">
<figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mu[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;</span><br><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; ++i) {</span><br><span class="line">    <span class="hljs-keyword">if</span> (!mindiv[i]) prime[++tot] = mindiv[i] = i, mu[i] = <span class="hljs-number">-1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= tot; ++j) {</span><br><span class="line">        <span class="hljs-keyword">if</span> (prime[j] &gt; mindiv[i] || prime[j] * i &gt; n) <span class="hljs-keyword">break</span>;</span><br><span class="line">    	mindiv[prime[j] * i] = prime[j];</span><br><span class="line">        mu[prime[j] * i] = (i % prime[j]) ? -mu[i] : <span class="hljs-number">0</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

</div></div>

<h3 id="线性筛-varphi"><a href="#线性筛-varphi" class="headerlink" title="线性筛 $\varphi$"></a>线性筛 $\varphi$</h3><p>欧拉函数 $\varphi$ 是积性函数，定义为 </p>
<p>$$<br>\varphi(n)=\sum_{i=1}^n[i\bot n]<br>$$</p>
<p>同时有 $\varphi$ 计算公式（证明见<a href="">这里</a>) </p>
<p>$$<br>\varphi(n)=n\prod_{i=1}^m \frac{p_i-1}{p_i}<br>$$</p>
<p>由计算公式知，第三类情况 </p>
<p>$$<br>\varphi(n)=\varphi(p_1^k)\times\varphi(j)=(p_1-1)\times p_1^{k-1}\times \varphi(j)\<br>\varphi(i)=\varphi(p_1^{k_1-1})\times \varphi(j)=(p_1-1)\times p_1^{k_1-2}\times \varphi(j)<br>$$</p>
<p>因此有 </p>
<p>$$<br>\varphi(n)=\varphi(i)\times p_1<br>$$</p>
<table>
<thead>
<tr>
<th align="center">$n$ 与 $p_1$ 关系</th>
<th align="center">$\varphi(n)$</th>
</tr>
</thead>
<tbody><tr>
<td align="center">$n$ 是素数 $p_1$</td>
<td align="center">$n-1$</td>
</tr>
<tr>
<td align="center">$n=p_1\times i$，且 $p_1\nmid i$</td>
<td align="center">$\varphi(p_1)\times \varphi(i)=(p_1-1)\times \varphi(i)$</td>
</tr>
<tr>
<td align="center">$n=p_1\times i$，且 $p_1\mid i$</td>
<td align="center">$\varphi(p_1^k)\times\varphi(j)=p_1\times \varphi(i)$</td>
</tr>
</tbody></table>
<div><div class="fold_hider"><div class="close hider_title">Sample-Code</div></div><div class="fold">
<figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">phi[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;</span><br><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; ++i) {</span><br><span class="line">    <span class="hljs-keyword">if</span> (!phi[i]) prime[++tot] = i, phi[i] = i - <span class="hljs-number">1</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= tot; ++j) {</span><br><span class="line">        <span class="hljs-keyword">if</span> (prime[j] &gt; mindiv[i] || prime[j] * i &gt; n) <span class="hljs-keyword">break</span>;</span><br><span class="line">    	phi[prime[j] * i] = phi[i] * ((i % prime[j]) ? prime[j] - <span class="hljs-number">1</span> : prime[j]);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

</div></div>

<h3 id="关于-sigma-k"><a href="#关于-sigma-k" class="headerlink" title="关于 $\sigma_k$"></a>关于 $\sigma_k$</h3><p>约束幂和函数 $\sigma_k$ 是积性函数，定义为<br>$$<br>\sigma_k(n)=\sum_{d|n}d^k<br>$$<br>也就是说，$\sigma_k$ 是一个函数族，代表 $n$ 的约数的 $k$ 次幂和。</p>
<p>下面我们从简到难介绍 $\sigma_k$ 的求法。</p>
<h3 id="线性筛-tau"><a href="#线性筛-tau" class="headerlink" title="线性筛 $\tau$"></a>线性筛 $\tau$</h3><p>约数个数函数 $\tau=\sigma_0$ 是积性函数，即约束的 $0$ 次幂和，定义为<br>$$<br>\tau(n)=\sigma_0(n)=\sum [d | n]<br>$$<br>利用多集合的计数思路，对于 $n$ 的标准分解，有<br>$$<br>\tau(n)=\sigma_0(n)=\prod_{i=1}^m (k_i+1)<br>$$</p>
<p>同样直接分类讨论即可，但注意维护 $g(n)$ 和计算 $\tau(p^k)$ 的位置。</p>
<table>
<thead>
<tr>
<th align="center">$n$ 与 $p_1$ 关系</th>
<th align="center">$\tau(n)$</th>
</tr>
</thead>
<tbody><tr>
<td align="center">$n$ 是素数 $p_1$</td>
<td align="center">$2$</td>
</tr>
<tr>
<td align="center">$n=p_1\times i$，且 $p_1\nmid i$</td>
<td align="center">$\tau(p_1)\times \tau(i)=2\tau(i)$</td>
</tr>
<tr>
<td align="center">$n=p_1\times i$，且 $p_1\mid i$</td>
<td align="center">$\tau(p_1^k)\times\tau(j)$</td>
</tr>
</tbody></table>
<div><div class="fold_hider"><div class="close hider_title">Sample-Code</div></div><div class="fold">
<figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">g[<span class="hljs-number">1</span>] = tau[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;</span><br><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; ++i) {</span><br><span class="line">    <span class="hljs-keyword">if</span> (!mindiv[i]) {</span><br><span class="line">       	g[i] = i;</span><br><span class="line">        tau[i] = <span class="hljs-number">2</span>;</span><br><span class="line">        prime[++tot] = mindiv[i] = i;</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>, temp; j &lt;= tot; ++j) {</span><br><span class="line">        temp = prime[j] * i;</span><br><span class="line">        <span class="hljs-keyword">if</span> (prime[j] &gt; mindiv[i] || temp &gt; n) <span class="hljs-keyword">break</span>;</span><br><span class="line">    	<span class="hljs-keyword">if</span> (prime[j] == mindiv[i]) {</span><br><span class="line">            g[temp] = g[i] * prime[j];</span><br><span class="line">            <span class="hljs-keyword">if</span> (g[temp] == temp) tau[temp] = tau[g[i]] + <span class="hljs-number">1</span>;</span><br><span class="line">            <span class="hljs-keyword">else</span> tau[temp] = tau[g[temp]] * tau[i / g[i]];</span><br><span class="line">            <span class="hljs-keyword">continue</span>;</span><br><span class="line">        }</span><br><span class="line">        g[temp] = prime[j];</span><br><span class="line">        mindiv[temp] = prime[j];</span><br><span class="line">        tau[temp] = <span class="hljs-number">2</span> * tau[i];</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

</div></div>

<h3 id="线性筛-sigma"><a href="#线性筛-sigma" class="headerlink" title="线性筛 $\sigma$"></a>线性筛 $\sigma$</h3><p>约数和函数 $\sigma=\sigma_1$ 是积性函数，即约束的 $1$ 次幂和，定义为<br>$$<br>\sigma(n)=\sigma_1(n)=\sum_{d|n} d<br>$$<br>利用多集合的计数思路，对于 $n$ 的标准分解，有<br>$$<br>\sigma(n)=\sigma_1(n)=\prod_{i=1}^m \sum_{j=0}^{k_i} p_i^j<br>$$</p>
<p>同样直接分类讨论即可，注意维护 $g(n),k(n)$ 和计算 $\sigma(p^k)$ 的位置 。</p>
<p>由于计算 $\sigma(p^k)$ 单次复杂度为 $O(\log k)$，总复杂度依然保持线性。</p>
<table>
<thead>
<tr>
<th align="center">$n$ 与 $p_1$ 关系</th>
<th align="center">$\sigma(n)$</th>
</tr>
</thead>
<tbody><tr>
<td align="center">$n$ 是素数 $p_1$</td>
<td align="center">$p_1+1$</td>
</tr>
<tr>
<td align="center">$n=p_1\times i$，且 $p_1\nmid i$</td>
<td align="center">$\sigma(p_1)\times \sigma(i)=(p_1+1)\times \sigma(i)$</td>
</tr>
<tr>
<td align="center">$n=p_1\times i$，且 $p_1\mid i$</td>
<td align="center">$\sigma(p_1^k)\times\sigma(j)$</td>
</tr>
</tbody></table>
<div><div class="fold_hider"><div class="close hider_title">Sample-Code</div></div><div class="fold">
<figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">g[<span class="hljs-number">1</span>] = k[<span class="hljs-number">1</span>] = sigma[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;</span><br><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; ++i) {</span><br><span class="line">    <span class="hljs-keyword">if</span> (!mindiv[i]) {</span><br><span class="line">       	g[i] = i;</span><br><span class="line">        k[i] = <span class="hljs-number">1</span>;</span><br><span class="line">        sigma[i] = i + <span class="hljs-number">1</span>;</span><br><span class="line">        prime[++tot] = mindiv[i] = i;</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>, temp; j &lt;= tot; ++j) {</span><br><span class="line">        temp = prime[j] * i;</span><br><span class="line">        <span class="hljs-keyword">if</span> (prime[j] &gt; mindiv[i] || temp &gt; n) <span class="hljs-keyword">break</span>;</span><br><span class="line">    	<span class="hljs-keyword">if</span> (prime[j] == mindiv[i]) {</span><br><span class="line">            k[temp] = k[i] + <span class="hljs-number">1</span>;</span><br><span class="line">            g[temp] = g[i] * prime[j];</span><br><span class="line">            <span class="hljs-keyword">if</span> (g[temp] == temp) sigma[temp] = sigma[g[i]] + fpow(prime[j], k[i]);</span><br><span class="line">            <span class="hljs-keyword">else</span> sigma[temp] = sigma[g[temp]] * sigma[i / g[i]];</span><br><span class="line">            <span class="hljs-keyword">continue</span>;</span><br><span class="line">        }</span><br><span class="line">        g[temp] = prime[j];</span><br><span class="line">        k[temp] = <span class="hljs-number">1</span>;</span><br><span class="line">        mindiv[temp] = prime[j];</span><br><span class="line">        sigma[temp] = (prime[j] + <span class="hljs-number">1</span>) * sigma[i];</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

</div></div>

<h3 id="线性筛-sigma-k"><a href="#线性筛-sigma-k" class="headerlink" title="线性筛 $\sigma_k$"></a>线性筛 $\sigma_k$</h3><p>约数幂和函数 $\sigma_k$ 是积性函数，即约束的 $k$ 次幂和，定义为<br>$$<br>\sigma_k(n)=\sum_{d|n} d^k<br>$$<br>为避免重复，用大写 $K$ 表示所求幂次。</p>
<p>同样直接分类讨论即可，注意维护 $g(n),k(n)$ 和计算 $\sigma_k(p^k)$ 的位置 。</p>
<p>此时计算 $\sigma_k(p^k)$ 单次复杂度为 $\mathcal O(\log (k\times K))$，总复杂度<strong>不再保持线性</strong>。</p>
<table>
<thead>
<tr>
<th align="center">$n$ 与 $p_1$ 关系</th>
<th align="center">$\sigma_k(n)$</th>
</tr>
</thead>
<tbody><tr>
<td align="center">$n$ 是素数 $p_1$</td>
<td align="center">$p_1^{K}+1$</td>
</tr>
<tr>
<td align="center">$n=p_1\times i$，且 $p_1\nmid i$</td>
<td align="center">$\sigma(p_1)\times \sigma(i)$</td>
</tr>
<tr>
<td align="center">$n=p_1\times i$，且 $p_1\mid i$</td>
<td align="center">$\sigma(p_1^k)\times\sigma(j)$</td>
</tr>
</tbody></table>
<div><div class="fold_hider"><div class="close hider_title">Sample-Code</div></div><div class="fold">
<figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">g[<span class="hljs-number">1</span>] = k[<span class="hljs-number">1</span>] = sigma[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;</span><br><span class="line"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; ++i) {</span><br><span class="line">    <span class="hljs-keyword">if</span> (!mindiv[i]) {</span><br><span class="line">       	g[i] = i;</span><br><span class="line">        k[i] = <span class="hljs-number">1</span>;</span><br><span class="line">        sigma[i] = fpow(i, K) + <span class="hljs-number">1</span>;</span><br><span class="line">        prime[++tot] = mindiv[i] = i;</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>, temp; j &lt;= tot; ++j) {</span><br><span class="line">        temp = prime[j] * i;</span><br><span class="line">        <span class="hljs-keyword">if</span> (prime[j] &gt; mindiv[i] || temp &gt; n) <span class="hljs-keyword">break</span>;</span><br><span class="line">    	<span class="hljs-keyword">if</span> (prime[j] == mindiv[i]) {</span><br><span class="line">            k[temp] = k[i] + <span class="hljs-number">1</span>;</span><br><span class="line">            g[temp] = g[i] * prime[j];</span><br><span class="line">            <span class="hljs-keyword">if</span> (g[temp] == temp) sigma[temp] = sigma[g[i]] + fpow(prime[j], k[i] * K);</span><br><span class="line">            <span class="hljs-keyword">else</span> sigma[temp] = sigma[g[temp]] * sigma[i / g[i]];</span><br><span class="line">            <span class="hljs-keyword">continue</span>;</span><br><span class="line">        }</span><br><span class="line">        g[temp] = prime[j];</span><br><span class="line">        k[temp] = <span class="hljs-number">1</span>;</span><br><span class="line">        mindiv[temp] = prime[j];</span><br><span class="line">        sigma[temp] = sigma[prime[j]] * sigma[i];</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

</div></div>

<h3 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h3><p>当 $K$ 很大的时候显然会超时，例如计算 $n=K=10^7$ 时，可以考虑打表。</p>
<p>找到 $p_i,k_i$ 可能的最大值，得到 $p\le 4\times 10^3,k_i\le 25$，直接记忆化省掉快速幂。</p>
<div><div class="fold_hider"><div class="close hider_title">Sample-Code</div></div><div class="fold">
<figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;</span><br><span class="line"><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e7</span> + <span class="hljs-number">10</span>, p = <span class="hljs-number">1000000007</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">// c[N] 即文中 k[N]</span></span><br><span class="line"><span class="hljs-keyword">int</span> n, k, pri[N], tot, c[N], mn[N], g[N];</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">bool</span> vis[N];</span><br><span class="line"></span><br><span class="line">ll f[N], ans;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">fpow</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, ll b)</span> </span>{</span><br><span class="line">	<span class="hljs-keyword">int</span> r = <span class="hljs-number">1</span>;</span><br><span class="line">	<span class="hljs-keyword">for</span>( ; b ; b &gt;&gt;= <span class="hljs-number">1</span>, a = (ll) a * a % p) <span class="hljs-keyword">if</span>(b &amp; <span class="hljs-number">1</span>) r = (ll) r * a % p;</span><br><span class="line">	<span class="hljs-keyword">return</span> r;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> val[<span class="hljs-number">4000</span>][<span class="hljs-number">25</span>];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">F</span><span class="hljs-params">(<span class="hljs-keyword">int</span> mn, <span class="hljs-keyword">int</span> c)</span> </span>{</span><br><span class="line">	<span class="hljs-keyword">if</span>(val[mn][c] != <span class="hljs-number">-1</span>) <span class="hljs-keyword">return</span> val[mn][c];</span><br><span class="line">	<span class="hljs-keyword">int</span> r = <span class="hljs-number">0</span>;</span><br><span class="line">	<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span> ; j &lt;= c ; ++ j) r = ((ll) r + fpow(mn, (ll) j * k)) % p;</span><br><span class="line">	<span class="hljs-keyword">return</span> val[mn][c] = r;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">	<span class="hljs-built_in">memset</span>(val, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> val);</span><br><span class="line">	<span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d%d"</span>, &amp;n, &amp;k);</span><br><span class="line">	ans = f[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;</span><br><span class="line">	<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span> ; i &lt;= n ; ++ i) {</span><br><span class="line">		<span class="hljs-keyword">if</span>(!vis[i]) pri[++ tot] = i, f[i] = <span class="hljs-number">1</span> + fpow(i, k), g[i] = i, c[i] = <span class="hljs-number">1</span>, mn[i] = i;</span><br><span class="line">		<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span> ; j &lt;= tot &amp;&amp; (ll) i * pri[j] &lt;= n ; ++ j) {</span><br><span class="line">			<span class="hljs-keyword">int</span> x = i * pri[j];</span><br><span class="line">			vis[x] = <span class="hljs-number">1</span>;</span><br><span class="line">			<span class="hljs-keyword">if</span>(i % pri[j] == <span class="hljs-number">0</span>) {</span><br><span class="line">				f[x] = f[i / g[i]] * F(mn[i], c[i] + <span class="hljs-number">1</span>) % p;</span><br><span class="line">				g[x] = g[i] * pri[j];</span><br><span class="line">				c[x] = c[i] + <span class="hljs-number">1</span>;</span><br><span class="line">				mn[x] = pri[j];</span><br><span class="line">				<span class="hljs-keyword">break</span>;</span><br><span class="line">			} <span class="hljs-keyword">else</span> f[x] = f[i] * f[pri[j]] % p, g[x] = pri[j], c[x] = <span class="hljs-number">1</span>, mn[x] = pri[j];</span><br><span class="line">		}</span><br><span class="line">		ans = (ans + f[i]) % p;</span><br><span class="line">	}</span><br><span class="line">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%lld\n"</span>, ans);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

</div></div>

<hr>
<h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><p>对于一些未定义积性函数，线性筛的应用。</p>
<h3 id="2018-南京网络预赛-Sum"><a href="#2018-南京网络预赛-Sum" class="headerlink" title="[2018 南京网络预赛] Sum"></a><a target="_blank" rel="noopener" href="https://nanti.jisuanke.com/t/A1956">[2018 南京网络预赛] Sum</a></h3><p>定义 $f(x)$ 为满足以下条件的<strong>有序</strong>二元组 $(a,b)$ 的方案数</p>
<ul>
<li>$x = a\times b$</li>
<li>$a$ 和 $b$ 均无平方因子 ( $\mu(a)\neq 0,\mu(b)\neq 0$ )</li>
</ul>
<p>求 $\sum_{i=1}^n f(i)$，数据范围 $n\le 2\times 10^7$ </p>
<p><strong>Solution</strong></p>
<p>显然 $f(x)=\sum_{d|x} abs(\mu(d)\mu(\frac nd))$，是积性函数（相当于是重定义让 $\mu\ge 0$， $\mu*\mu$ ）。</p>
<table>
<thead>
<tr>
<th align="center">$n$ 与 $p_1$ 关系</th>
<th align="center">$f(n)$</th>
</tr>
</thead>
<tbody><tr>
<td align="center">$n$ 是素数 $p_1$</td>
<td align="center">$2$</td>
</tr>
<tr>
<td align="center">$n=p_1\times i$，且 $p_1\nmid i$</td>
<td align="center">$f(p_1)\times f(i)=2f(i)$</td>
</tr>
</tbody></table>
<p>对于 $n=p_1\times i$，且 $p_1\mid i$ 的情况，讨论：</p>
<ul>
<li><p>若 $p_1 | \frac i{p_1}$ 即 $p_1 | \frac{n}{p_1^2}$ 时， $n$ 中 $p_1$ 的指数至少为 $3$ ，无论如何划分 $(a,b)$，都有一个 $\mu = 0$ ， $f(n) = 0$ </p>
</li>
<li><p>否则 $p_1$ 的指数为 $2$ ， 产生贡献必须把 $p_1$ 分给 $a$ 和 $b$ 各一个，即方案数 $f(n) = f(\frac{n}{p_1^2})$</p>
</li>
</ul>
<figure class="highlight c++ hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> N 20000007ll</span></span><br><span class="line"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">rd</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">  <span class="hljs-keyword">int</span> x = <span class="hljs-number">0</span>;</span><br><span class="line">  <span class="hljs-keyword">char</span> c = getchar();</span><br><span class="line">  <span class="hljs-keyword">while</span> (!<span class="hljs-built_in">isdigit</span>(c)) c = getchar();</span><br><span class="line">  <span class="hljs-keyword">while</span> (<span class="hljs-built_in">isdigit</span>(c)) {</span><br><span class="line">    x = x * <span class="hljs-number">10</span> + (c ^ <span class="hljs-number">48</span>);</span><br><span class="line">    c = getchar();</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-keyword">return</span> x;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">bool</span> vis[N];</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">int</span> tot, f[N], prm[N];</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">  f[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;</span><br><span class="line">  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt; N; ++i) {</span><br><span class="line">    <span class="hljs-keyword">if</span> (!vis[i]) prm[++tot] = i, f[i] = <span class="hljs-number">2</span>;</span><br><span class="line">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= tot; ++j) {</span><br><span class="line">       <span class="hljs-keyword">if</span> (<span class="hljs-number">1l</span>l * i * prm[j] &gt;= N) <span class="hljs-keyword">break</span>;</span><br><span class="line">       vis[i * prm[j]] = <span class="hljs-number">1</span>;</span><br><span class="line">       <span class="hljs-keyword">if</span> (i % prm[j] == <span class="hljs-number">0</span>) {</span><br><span class="line">         f[i * prm[j]] = ((i / prm[j]) % prm[j]) ? f[i / prm[j]] : <span class="hljs-number">0</span>;</span><br><span class="line">         <span class="hljs-keyword">break</span>;</span><br><span class="line">       }</span><br><span class="line">       f[i * prm[j]] = f[i] &lt;&lt; <span class="hljs-number">1</span>;</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; N; ++i) f[i] += f[i - <span class="hljs-number">1</span>];</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{</span><br><span class="line">  init();</span><br><span class="line">  <span class="hljs-keyword">int</span> t = rd();</span><br><span class="line">  <span class="hljs-keyword">while</span> (t--) <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d\n"</span>, f[rd()]);</span><br><span class="line">  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>(还有一种做法即 $f=\mu^2 *\mu^2$ ，反演即可，查询单次 $\mathcal O(\sqrt n)$ ，参考<a target="_blank" rel="noopener" href="https://www.cnblogs.com/lfri/p/11382166.html">这里</a>)</p>
</body></html>
    
    </div>
    
    <div class="columns is-variable is-1 is-multiline is-mobile">
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/%E7%BA%BF%E6%80%A7%E7%AD%9B/">#线性筛</a></span>
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop  article-nav-prev">
            
            <a href="/2021/07/08/freshman/">热爱生活</a>
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="/2019/06/01/mathjax/">Render Math Equations in Hexo</a>
            
        </span>
    </div>
    
</article>


<div class="sharebox">
    
<div class="sharethis-inline-share-buttons"></div>
<script type='text/javascript' src='https://platform-api.sharethis.com/js/sharethis.js#property=60598de34d1bac0012adf195&amp;product=inline-share-buttons' async='async'></script>

</div>



<div class="comments">
    <h3 class="title is-4">Comments</h3>
    
<div id="valine-thread"></div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<script>
    new Valine({
        el: '#valine-thread',
        appId: 'xG2rrgKMbyj4g3i1oO6vNAqH-gzGzoHsz',
        appKey: 'dzMAbhtChev9VMBGRYG9PvAv',
        notify: false,
        verify: false,
        avatar: '',
        placeholder: 'What you wanna say...',
        meta: ['nick', 'mail'],
        visitor: true,
        lang: 'en'
    })
</script>


</div>

    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2021 Colin&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        target="_blank" rel="noopener" href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            <div class="column is-narrow">
                <div class="columns is-mobile is-multiline is-centered">
                
                    
                <a class="column is-narrow has-text-black" title="Mail" href="mailto:sgcolin@163.com">
                    
                    Mail
                    
                </a>
                
                    
                <a class="column is-narrow has-text-black" title="GitHub" target="_blank" rel="noopener" href="https://github.com/sgcolin">
                    
                    GitHub
                    
                </a>
                
                </div>
            </div>
            
            
        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script>

<!-- test if the browser is outdated -->
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js"></script>
<script>
    $(document).ready(function () {
        // plugin function, place inside DOM ready function
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        })
    });
</script>

<script>
    window.FontAwesomeConfig = {
        searchPseudoElements: true
    }
    moment.locale("en-AU");
</script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        "HTML-CSS": {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
</script>

    
    
    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/js/jquery.justifiedGallery.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof($.fn.justifiedGallery) === 'function') {
                $('.justified-gallery').justifiedGallery();
            }
        });
    })(jQuery);
</script>

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <style>
        .hljs {
            position: relative;
        }

        .hljs .clipboard-btn {
            float: right;
            color: #9a9a9a;
            background: none;
            border: none;
            cursor: pointer;
        }

        .hljs .clipboard-btn:hover {
          color: #8a8a8a;
        }

        .hljs > .clipboard-btn {
            display: none;
            position: absolute;
            right: 4px;
            top: 4px;
        }

        .hljs:hover > .clipboard-btn {
            display: inline;
        }

        .hljs > figcaption > .clipboard-btn {
            margin-right: 4px;
        }
    </style>
    <script>
      $(document).ready(function () {
        $('figure.hljs').each(function(i, figure) {
          var codeId = 'code-' + i;
          var code = figure.querySelector('.code');
          var copyButton = $('<button>Copy <i class="far fa-clipboard"></i></button>');
          code.id = codeId;
          copyButton.addClass('clipboard-btn');
          copyButton.attr('data-clipboard-target-id', codeId);

          var figcaption = figure.querySelector('figcaption');

          if (figcaption) {
            figcaption.append(copyButton[0]);
          } else {
            figure.prepend(copyButton[0]);
          }
        })

        var clipboard = new ClipboardJS('.clipboard-btn', {
          target: function(trigger) {
            return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
          }
        });
        clipboard.on('success', function(e) {
          e.clearSelection();
        })
      })
    </script>

    
    

    



<script src="/js/script.js"></script>


    
    <div class="searchbox ins-search">
    <div class="searchbox-mask"></div>
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>

<script src="/js/insight.js"></script>

    
</body>
</html>