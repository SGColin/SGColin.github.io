<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Some Counting Tricks | SGColin's Space</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Some Counting Tricks</h1><a id="logo" href="/.">SGColin's Space</a><p class="description">God helps those who help themselves.</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/diary/"><i class="fa fa-calendar"> Diary</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Some Counting Tricks</h1><div class="post-meta">Dec 3, 2019<span> | </span><span class="category"><a href="/categories/Notes/">Notes</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">Contents</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#前置知识"><span class="toc-number">1.</span> <span class="toc-text">前置知识</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#全错位排列"><span class="toc-number">2.</span> <span class="toc-text">全错位排列</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#卡特兰数"><span class="toc-number">3.</span> <span class="toc-text">卡特兰数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第二类斯特林数"><span class="toc-number">4.</span> <span class="toc-text">第二类斯特林数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#小球装箱"><span class="toc-number">5.</span> <span class="toc-text">小球装箱</span></a></li></ol></div></div><div class="post-content"><p>做高考计数题的时候发现 OI 里的一些东西挺好用。</p>
<p>简单整理一下，可能对于高考略超纲，但是不难上手。</p>
<a id="more"></a>
<h2 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h2><p>内容很基础，但是我想说的是，计数题的计算公式还是从实际意义去理解比较好。</p>
<ul>
<li><p><strong>排列 (Permutations)</strong></p>
<script type="math/tex; mode=display">
P_{n}^m=\frac{n!}{(n-m)!}</script><p>从 $n$ 个不同的元素里，选出 $m$ 个进行全排列的方案数。</p>
<p>分子 $n!$ 的含义是 $n$ 个元素的全排列，其中有 $n-m$ 个是不需要的，因此他们的顺序没有意义，去掉不同顺序带来的计数，除掉 $n-m$ 的全排列数 $(n-m)!$ </p>
</li>
<li><p><strong>组合 (Combination)</strong></p>
<script type="math/tex; mode=display">
C_n^m=\frac{n!}{m!(n-m)!}</script><p>从 $n$ 个不同的元素里，选出 $m$ 个组成一个集合的方案数。</p>
<p>相当于排列数中的 $m$ 个元素去掉顺序，即 $P_n^m$ 再除掉 $m$ 的全排列数 $m!$</p>
</li>
<li><p><strong>顺序化与去顺序</strong></p>
<p>从排列数和组合数的定义可以看出，排列的顺序带来了更多的方案数；</p>
<p>而组合的选取集合无序性，使得方案数去掉了 $m$ 个元素内部顺序。</p>
<p>我们可以笼统的归纳出：$m$ 个元素有顺序的方案数 $=$ 无顺序的方案数 $\times \ m!$</p>
<p>这样就可以很好地解释一个恒等式：$P_n^m=C_n^m\times m!$</p>
<p>有序与无序的转换可以通过乘或除全排列来实现，这个思想后面我们还会用到。</p>
</li>
<li><p><strong>一个组合恒等式</strong></p>
<script type="math/tex; mode=display">
C_n^m=C_{n-1}^{m-1}+C_{n-1}^m</script><p>含义是，从 $n$ 个不同的元素里，选出 $m$ 个组成一个集合的方案，可以由两种情况发展而来：</p>
<ol>
<li>选上第 $n$ 个元素，前 $n-1$ 个元素中选取 $m-1$ 个。</li>
<li>不选第 $n-1$ 个元素，前 $m-1$ 个元素中选取 $m$ 个。</li>
</ol>
<p>这种<strong>增量的思维，即单独考虑第 $n$ 个元素的选取策略</strong>的思考方式很重要，在后面也还会用到。</p>
</li>
</ul>
<h2 id="全错位排列"><a href="#全错位排列" class="headerlink" title="全错位排列"></a>全错位排列</h2><p>指 $n$ 个不同元素的全排列，使得对于任何 $i(i\in[1,n])$ ，满足第 $i$ 个位置上的数不是 $i$ 的排列数。</p>
<p>  其通项公式确实不太好记忆，但是递推公式非常好记忆：</p>
<script type="math/tex; mode=display">
  D_1 = 0\ ,\ D_2 = 1
  \\D_n=(n-1)(D_{n-1}+D_{n-2})\ (n\ge 3)</script><p>  公式的含义是，当 $n\ge 3$ 时，用增量的思维，单独考虑数字 $n$ 在排列中的位置。</p>
<p>  不妨设 $n$ 排在了第 $k$ 位，其中 $k\not = n$，也就是 $k\in [1,n-1]$，这是考虑第 $n$ 位的情况：</p>
<ol>
<li>当数字 $k$ 排在第 $n$ 位时，除了 $n$ 和 $k$ 以外还有 $n-2$ 个数，其错排数为 $D_{n-2}$。</li>
<li>当 $k$ 不排在第 $n$ 位时，那么将第 $n$ 位重新考虑成一个新的“第 $k$ 位”，这时的包括 $k$ 在内的剩下 $n-1$ 个数的每一种错排，都等价于只有 $n-1$个数时的错排（只是其中的第 $k$ 位会换成第 $n$ 位），其错排数为 $D_{n-1}$。</li>
</ol>
<p>这两种情况是独立的，而 $k$ 的选取又有 $n-1$ 种，所以 $D_n=(n-1)(D_{n-1}+D_{n-2})$</p>
<p><del>其实按照某老师所言，你高考的时候忘记了 D5 到底是多少，需要花一个小时。</del></p>
<p><del>但你记住了递推公式其实真的不需要一个小时。</del></p>
<h2 id="卡特兰数"><a href="#卡特兰数" class="headerlink" title="卡特兰数"></a>卡特兰数</h2><p>  <del>会了这个在 2016 年的高考题里选择压轴 12 题你就可以一秒算出。</del></p>
<p>  这个数列的含义有很多，这里先给出公式再解释：</p>
<script type="math/tex; mode=display">
  \begin{align}
  H_n=\frac{C_{2n}^{n}}{n+1}=\frac{\prod_{i=n+2}^{2n}i}{n!}\end{align}</script><p>  比较常见的一种定义是：从原点 $(0,0)$ 到点 $B(n,n)$ ，只能向右或向上进行长度为一个单位的移动，<strong>路线一直处于 $y=x$ 之下</strong>的方案数；</p>
<p>  <img src="https://i.loli.net/2019/12/13/S9WAc7rw3qEuVKz.png" style="zoom:67%;"></p>
<ol>
<li><p>总共需要走的步数为 $2n$ 步，而向右一共要走 $n$ 步，故总的方案数为 $C_{2n}^{n}$ 。</p>
</li>
<li><p>不合法的方案即为越过 $y=x$ 的路径数，考虑将每一个不合法的方案中从 $(0,0)$ 到<strong>第一个</strong>越过 $y=x$ 的点这一部分的路径关于 $y=x+1$对称，其余部分不变。我们发现，每一个不合法的路径都一一映射到了一个从 $(-1,1)$ 到 $(n,n)$ 的路径，那么不合法的方案数即为从 $(-1,1)$ 走到 $(n,n)$ 的方案数，因为一共向上要走$n-1$步，向右一共要走$n+1$步，所以不合法的方案数为 $C_{2n}^{n-1}$或 $C_{2n}^{n+1}$。</p>
</li>
<li>做一个减法，整理一下就得到了公式：</li>
</ol>
<script type="math/tex; mode=display">
H_n=C_{2n}^n-C_{2n}^{n-1}=C_{2n}^n - C_{2n}^{n}\times \frac{n}{n+1}=\frac{C_{2n}^{n}}{n+1}</script><p>Catalan 数还有以下几中比较常见的解释：</p>
<ul>
<li><p>$n$ 个 $0$ 与 $n$ 个 $1$ 构成的序列，使得任何一个前缀 $0$ 的个数不少于 $1$ 的方案数。</p>
<p>也就是  16 年高考题的题面啦，把 $0$ 当作向右走一步，把 $1$ 当作向上走一步，就可以解释了。</p>
</li>
<li><p>给定 $n$ 对括号，求所有括号正确配对的括号序列数。</p>
<p>把左括号当作向右走一步，把右括号当作向上走一步，就可以解释了。</p>
</li>
<li><p>将一个 $n+2$ 条边的凸多边形，通过若干条互不相交的对角线，划分成 $n$ 个三角形的方案数。</p>
<p>这个用组合数学不太好解释，想听的同学找我吧…</p>
</li>
</ul>
<h2 id="第二类斯特林数"><a href="#第二类斯特林数" class="headerlink" title="第二类斯特林数"></a>第二类斯特林数</h2><p>第一类 Stirling 数貌似用处不太大就先不讲了…</p>
<p>第二类 Stirling 数是一个二维数表，$S_n^m$ 表示将 $n$ 个不同的元素，划分成 $m$ 个不同的非空集合的方案数。</p>
<script type="math/tex; mode=display">
S_n^m=S_{n-1}^{m-1}+m\times S_{n-1}^m</script><p>同样以增量的角度思考递推式的形式。</p>
<ul>
<li>如果第 $n$ 个元素单独作为一个集合，则方案唯一，剩下的部分组成 $m-1$ 个集合，贡献为 $S_{n−1}^{m−1}$ 。 </li>
<li>如果第 $n$ 个元素加入之前的集合，那么有 $m$ 个集合可以选择，贡献是 $m\times S_{n-1}^m$ 。</li>
</ul>
<p>对于一些边界的情况很容易得到结论：</p>
<script type="math/tex; mode=display">
S_n^0=0,S_n^1=1,S_n^n=1,S_n^m=0(m>n)</script><p>所以简单的二维数表也就不难推出：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">n\m</th>
<th style="text-align:center">0</th>
<th style="text-align:center">1</th>
<th style="text-align:center">2</th>
<th style="text-align:center">3</th>
<th style="text-align:center">4</th>
<th style="text-align:center">5</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1</td>
<td style="text-align:center">3</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1</td>
<td style="text-align:center">7</td>
<td style="text-align:center">6</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1</td>
<td style="text-align:center">15</td>
<td style="text-align:center">25</td>
<td style="text-align:center">10</td>
<td style="text-align:center">1</td>
</tr>
</tbody>
</table>
</div>
<p>用法在后面我们会提到。</p>
<h2 id="小球装箱"><a href="#小球装箱" class="headerlink" title="小球装箱"></a>小球装箱</h2><p>由球、盒子是否相同，盒子是否可空组合成的八种问题。</p>
<p>鉴于是面向高考题目的一份总结，这里只说六种比较好操作的情况。</p>
<p>问题格式为，有 $n$ 个（同/不同）的球，放到 $m$ 个（同/不同）的盒子中，要求盒子（可以/不可以）空。</p>
<p>这里先给出问题的答案，再逐一说明。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">球</th>
<th style="text-align:center">盒</th>
<th style="text-align:center">是否可空</th>
<th style="text-align:center">Answer</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">同</td>
<td style="text-align:center">不同</td>
<td style="text-align:center">不可空</td>
<td style="text-align:center">$C_{n-1}^{m-1}$</td>
</tr>
<tr>
<td style="text-align:center">同</td>
<td style="text-align:center">不同</td>
<td style="text-align:center">可空</td>
<td style="text-align:center">$C_{n+m-1}^n$</td>
</tr>
<tr>
<td style="text-align:center">不同</td>
<td style="text-align:center">同</td>
<td style="text-align:center">不可空</td>
<td style="text-align:center">$S_n^i$</td>
</tr>
<tr>
<td style="text-align:center">不同</td>
<td style="text-align:center">同</td>
<td style="text-align:center">可空</td>
<td style="text-align:center">$\sum_{i=1}^mS_n^i$</td>
</tr>
<tr>
<td style="text-align:center">不同</td>
<td style="text-align:center">不同</td>
<td style="text-align:center">不可空</td>
<td style="text-align:center">$S_n^m\times P_m^m$</td>
</tr>
<tr>
<td style="text-align:center">不同</td>
<td style="text-align:center">不同</td>
<td style="text-align:center">可空</td>
<td style="text-align:center">$m^n$</td>
</tr>
</tbody>
</table>
</div>
</div><iframe src="/donate/?AliPayQR=/img/AliPayQR.png&amp;WeChatQR=/img/WeChatQR.png&amp;GitHub=https://github.com/sgcolin## GitHub URL, e.g. https://github.com/Kaiyuan/donate-page&amp;BTCQR=null&amp;BTCKEY=null&amp;PayPal=null" style="overflow-x:hidden; overflow-y:hidden; border:0xp none #fff; min-height:240px; width:100%;" frameborder="0" scrolling="no"></iframe><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a class="article-share-link" data-url="http://blog.gyx.me/2019/12/03/count-in-gk/" data-id="ck426s8g20000s4ufeix6z8n9" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAACuCAAAAACKZ2kyAAABwElEQVR42u3aQXLCMAwF0N7/0nTLBvMl2YZ2nldMEpKXLDSSrJ+feD2eVu/K5yP53ZoLFxd3zH0s1/qaV2fX0PULrO+Gi4t7k/sqYlQfM4k8awMuLu5f4c4THVxc3P/B3RvacHFxv5mbpyB5UJuUTxtqNVxc3AE371Ke+32kv4uLi9viPoorSUdeJUPzhYuLe4c7aXNUX2ZbewUXF/cwN29h5O2P/Eieybw7gYuLe5Y7qZ/Wyc083cHFxb3DXRctk6BTDW2FtAkXF/cwt5eI9LZRq5srL4sfXFzcK9wqOm+J9sqhQsTFxcU9wO2lLHk4myRMSfqFi4t7gpsnNMkje8fzZgouLu4dbtLCmLdOehNW0Z4wLi7uMW5v8KIw39G6pvchcHFxd3F7Y1XVO+Sv8eZfuLi4F7n5FmnysGSEK78SFxf3s9zmlkbcSN2QheHi4h7mNocm47CVfI5C4wMXF/cKd1eLsxeYdpVMuLi4J7j5lkbevKiOdRaSIVxc3IvcSZujOs61oVbDxcX9Mm41KckbslHyhIuL+8XcbXVVvNWKi4t7n9sbnczDVq+gwsXF/RR3Hlx6DZFeeoSLi3uY+wvyGKRTP/fLzQAAAABJRU5ErkJggg==">Share</a><div class="tags"><a href="/tags/Math/">Math</a></div><div class="post-nav"><a class="next" href="/2019/07/27/math-in-noip/">Number Theory in NOIP</a></div><div id="container"></div><link rel="stylesheet" type="text/css" href="//unpkg.com/gitalk/dist/gitalk.css?v=0.0.0"><script type="text/javascript" src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js?v=0.0.0"></script><script type="text/javascript" src="//unpkg.com/gitalk/dist/gitalk.min.js?v=0.0.0"></script><script>var gitalk = new Gitalk({
  clientID: '8118f21e816f9e04ef25',
  clientSecret: 'd300b272239621b202a0bcf947eff66d9891d870',
  repo: 'Speak',
  owner: 'SGColin',
  admin: ['SGColin'],
  id: md5(location.pathname),
  distractionFreeMode: false
})
gitalk.render('container')
</script></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Notes/">Notes</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Summary/">Summary</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Travel/">Travel</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/OI/" style="font-size: 15px;">OI</a> <a href="/tags/Life/" style="font-size: 15px;">Life</a> <a href="/tags/Math/" style="font-size: 15px;">Math</a> <a href="/tags/Blog/" style="font-size: 15px;">Blog</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/12/03/count-in-gk/">Some Counting Tricks</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/27/math-in-noip/">Number Theory in NOIP</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/14/cts2019-apio2019/">CTS 2019  & APIO 2019</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/04/27/derivation/">Essence of Derivation</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/04/12/heoi2019/">HEOI 2019</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/04/03/mathjaxtest/">MathJax Test</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/05/polynomial/">Templates of Polynomial</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/04/goodbye-wuxu/">Goodbye Wuxu</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/08/noip2018/">NOIP 2018</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/29/hello-world/">Hello World</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="mailto:m15831738392@163.com" title="Contact me" target="_blank">Contact me</a><ul></ul><a href="https://github.com/sgcolin" title="Fork me on GitHub" target="_blank">Fork me on GitHub</a><ul></ul><a href="https://czyhe.me/" title="Czyhe" target="_blank">Czyhe</a><ul></ul><a href="https://www.cnblogs.com/ZH-comld/" title="Zh_comld" target="_blank">Zh_comld</a><ul></ul><a href="https://www.cnblogs.com/ErkkiErkko/" title="ErkkiErkko" target="_blank">ErkkiErkko</a><ul></ul><a href="https://captainslow.cf/" title="Captainslow" target="_blank">Captainslow</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2019 <a href="/." rel="nofollow">SGColin's Space.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML" async="async"></script></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>